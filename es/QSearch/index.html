<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/es/images/logo-192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/es/images/logo-192.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/es/images/logo.png">
  <link rel="mask-icon" href="/es/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="rbaH_zC-qBwXaawJ10Mno3FHzv9HRFHGFdXx2f1BwyI">

<link rel="stylesheet" href="/es/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.0/css/all.min.css">

<script data-ad-client="ca-pub-2317298287519457" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"leihao0.github.io","root":"/es/","scheme":"Pisces","version":"8.0.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Buscando...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/es/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="contenido de investigación   Leer NTFS MFT  Construcción de la tabla hash  La ruta del sistema del archivo  GUI y subprocesos de trabajo  Múltiples métodos de búsqueda  Interfaz MFC   plan de investig">
<meta property="og:type" content="article">
<meta property="og:title" content="La conjetura principal y la realización de todo">
<meta property="og:url" content="https://leihao0.github.io/es/QSearch/index.html">
<meta property="og:site_name" content="LeiHao&#39;s Blog">
<meta property="og:description" content="contenido de investigación   Leer NTFS MFT  Construcción de la tabla hash  La ruta del sistema del archivo  GUI y subprocesos de trabajo  Múltiples métodos de búsqueda  Interfaz MFC   plan de investig">
<meta property="og:locale" content="es_ES">
<meta property="article:published_time" content="2012-05-26T14:44:42.000Z">
<meta property="article:modified_time" content="2020-12-20T23:53:08.062Z">
<meta property="article:author" content="LeiHao">
<meta property="article:tag" content="Programming">
<meta property="article:tag" content="Everything">
<meta property="article:tag" content="NTFS">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://leihao0.github.io/es/QSearch/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'es'
  };
</script>

  <title>La conjetura principal y la realización de todo | LeiHao's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-159363268-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-159363268-1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?25f016f633270b8e0baf56c4fe6f2dc1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/es/atom.xml" title="LeiHao's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Cambiar a barra de navegación">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/es/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">LeiHao's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/es/" rel="section"><i class="fa fa-home fa-fw"></i>Inicio</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/es/about/" rel="section"><i class="fa fa-user fa-fw"></i>Sobre mi</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/es/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archivo</a>

  </li>
        <li class="menu-item menu-item-rss">

    <a href="/es/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Buscar
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Buscando..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Tabla de contenidos
        </li>
        <li class="sidebar-nav-overview">
          Inicio
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Ubicacion-rapida-de-archivos-de-disco-NTFS"><span class="nav-number">1.</span> <span class="nav-text">Ubicación rápida de archivos de disco NTFS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Introduccion"><span class="nav-number">1.1.</span> <span class="nav-text">1. Introducción</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Breve-introduccion-a-NTFS"><span class="nav-number">1.2.</span> <span class="nav-text">2 Breve introducción a NTFS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-NTFS"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 NTFS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Situacion-actual"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 Situación actual</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Preparacion"><span class="nav-number">1.3.</span> <span class="nav-text">3 Preparación</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Ideas-de-diseno"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 Ideas de diseño</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Que-es-USN"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 Qué es USN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%C2%BFPor-que-es-rapido"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.3 ¿Por qué es rápido?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Medio-ambiente"><span class="nav-number">1.3.4.</span> <span class="nav-text">3.4 Medio ambiente</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Implementacion-del-programa"><span class="nav-number">1.4.</span> <span class="nav-text">4 Implementación del programa</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-Leer-USN"><span class="nav-number">1.4.1.</span> <span class="nav-text">4.1 Leer USN</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-1-Determine-el-formato-del-disco"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">4.1.1 Determine el formato del disco</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-2-Obtener-el-identificador-del-disco-de-la-unidad"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">4.1.2 Obtener el identificador del disco de la unidad</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-3-Inicializar-el-registro-de-USN"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">4.1.3 Inicializar el registro de USN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-4-Obtener-informacion-de-registro-de-USN"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">4.1.4 Obtener información de registro de USN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-5-Obtencion-de-informacion-de-archivo-de-USN-Journal"><span class="nav-number">1.4.1.5.</span> <span class="nav-text">4.1.5 Obtención de información de archivo de USN Journal</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-6-Eliminar-archivo-de-registro-USN"><span class="nav-number">1.4.1.6.</span> <span class="nav-text">4.1.6 Eliminar archivo de registro USN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-7-Resultados-de-enumerar-todos-los-archivos"><span class="nav-number">1.4.1.7.</span> <span class="nav-text">4.1.7 Resultados de enumerar todos los archivos</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-Generar-datos-de-busqueda"><span class="nav-number">1.4.2.</span> <span class="nav-text">4.2 Generar datos de búsqueda</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-1-Construir-vector"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">4.2.1 Construir vector</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-2-Construyendo-una-tabla-hash"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">4.2.2 Construyendo una tabla hash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-3-Insertar-datos"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">4.2.3 Insertar datos:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-Interfaz"><span class="nav-number">1.4.3.</span> <span class="nav-text">4.3 Interfaz</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-1-Principio-KISS"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">4.3.1 Principio KISS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-Funcion"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">4.3.2 Función</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-Unir-hilo"><span class="nav-number">1.4.4.</span> <span class="nav-text">4.4 Unir hilo</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-1-Por-que-unirse-a-hilos"><span class="nav-number">1.4.4.1.</span> <span class="nav-text">4.4.1 Por qué unirse a hilos</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-2-Iniciar-un-hilo-de-trabajo-en-MFC"><span class="nav-number">1.4.4.2.</span> <span class="nav-text">4.4.2 Iniciar un hilo de trabajo en MFC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-3-Minimizar-al-area-de-notificacion"><span class="nav-number">1.4.4.3.</span> <span class="nav-text">4.4.3 Minimizar al área de notificación</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-Encontrar"><span class="nav-number">1.4.5.</span> <span class="nav-text">4.5 Encontrar</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-1-Comodin"><span class="nav-number">1.4.5.1.</span> <span class="nav-text">4.5.1 Comodín</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-2-Estuche-pedido"><span class="nav-number">1.4.5.2.</span> <span class="nav-text">4.5.2 Estuche, pedido</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-3-Privacidad-del-usuario-y-ruta-del-sistema"><span class="nav-number">1.4.5.3.</span> <span class="nav-text">4.5.3 Privacidad del usuario y ruta del sistema</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-4-Implementacion"><span class="nav-number">1.4.5.4.</span> <span class="nav-text">4.5.4 Implementación</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-5-Salida-de-ruta"><span class="nav-number">1.4.5.5.</span> <span class="nav-text">4.5.5 Salida de ruta</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Analisis-de-complejidad"><span class="nav-number">1.5.</span> <span class="nav-text">5 Análisis de complejidad</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-Complejidad-del-tiempo"><span class="nav-number">1.5.1.</span> <span class="nav-text">5.1 Complejidad del tiempo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-Complejidad-espacial"><span class="nav-number">1.5.2.</span> <span class="nav-text">5.2 Complejidad espacial</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Problemas-encontrados"><span class="nav-number">1.6.</span> <span class="nav-text">6 Problemas encontrados</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-No-se-puede-inicializar-el-archivo-USN"><span class="nav-number">1.6.1.</span> <span class="nav-text">6.1 No se puede inicializar el archivo USN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-El-problema-de-wchar-y-char-bajo-Unicode"><span class="nav-number">1.6.2.</span> <span class="nav-text">6.2 El problema de wchar y char bajo Unicode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-Problema-de-posicion-ifdef"><span class="nav-number">1.6.3.</span> <span class="nav-text">6.3 Problema de posición #ifdef</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-Transferencia-de-parametros"><span class="nav-number">1.6.4.</span> <span class="nav-text">6.4 Transferencia de parámetros</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-pequenas-optimizaciones"><span class="nav-number">1.7.</span> <span class="nav-text">7 pequeñas optimizaciones</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-Velocidad-de-lectura"><span class="nav-number">1.7.1.</span> <span class="nav-text">7.1 Velocidad de lectura</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-Metodo-de-archivo-abierto"><span class="nav-number">1.7.2.</span> <span class="nav-text">7.2 Método de archivo abierto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-Barra-de-progreso"><span class="nav-number">1.7.3.</span> <span class="nav-text">7.3 Barra de progreso</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-Conclusion"><span class="nav-number">2.</span> <span class="nav-text">8 Conclusión</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#referencias"><span class="nav-number">3.</span> <span class="nav-text">referencias</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Resumen-en-ingles"><span class="nav-number">4.</span> <span class="nav-text">Resumen en ingles</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">LeiHao</p>
  <div class="site-description" itemprop="description">😃😃😃</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/es/archives/">
        
          <span class="site-state-item-count">160</span>
          <span class="site-state-item-name">entradas</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/es/tags/">
        <span class="site-state-item-count">81</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/leihao0" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;leihao0" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/leihao0" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;leihao0" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/leihao0" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;leihao0" rel="noopener" target="_blank"><i class="fab fa-linkedin-in fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" class="cc-opacity" rel="noopener" target="_blank"><img src="/es/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="es">
    <link itemprop="mainEntityOfPage" href="https://leihao0.github.io/es/QSearch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/es/images/avatar.gif">
      <meta itemprop="name" content="LeiHao">
      <meta itemprop="description" content="😃😃😃">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LeiHao's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          La conjetura principal y la realización de todo
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Publicado el</span>

      <time title="Creado por: 2012-05-26 22:44:42" itemprop="dateCreated datePublished" datetime="2012-05-26T22:44:42+08:00">2012-05-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Editado el</span>
        <time title="Modificado por: 2020-12-21 07:53:08" itemprop="dateModified" datetime="2020-12-21T07:53:08+08:00">2020-12-21</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/es/QSearch/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="QSearch/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="Cantidad de caracteres en el articulo">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Cantidad de caracteres en el articulo: </span>
      <span>26k</span>
    </span>
    <span class="post-meta-item" title="Tiempo de lectura">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Tiempo de lectura &asymp;</span>
      <span>24 minutos.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>contenido de investigación </p>
<ol>
<li>Leer NTFS MFT </li>
<li>Construcción de la tabla hash </li>
<li>La ruta del sistema del archivo </li>
<li>GUI y subprocesos de trabajo </li>
<li>Múltiples métodos de búsqueda </li>
<li>Interfaz MFC </li>
</ol>
<p>plan de investigación </p>
<ul>
<li>Principios de abril a mediados de abril para determinar la dirección de la investigación. </li>
<li>Desde finales de abril hasta finales de abril. Preparación para cada punto de conocimiento, prueba simple </li>
<li>A principios de mayo, depuración y operación del diseño y desarrollo del programa </li>
<li>Mediados de mayo-finales de mayo Redacción de tesis de diseño de graduación </li>
</ul>
<p>Características e innovación </p>
<ol>
<li>El uso de CPU y memoria están dentro de un rango razonable </li>
<li>El software es estable y ofrece diferentes opciones de búsqueda. </li>
<li>En comparación con la función de búsqueda de Windows, la velocidad de ubicación del archivo es súper rápida </li>
</ol>
<h1 id="Ubicacion-rapida-de-archivos-de-disco-NTFS"><a href="#Ubicacion-rapida-de-archivos-de-disco-NTFS" class="headerlink" title="Ubicación rápida de archivos de disco NTFS"></a>Ubicación rápida de archivos de disco NTFS</h1><p><strong>Resumen</strong> </p>
<blockquote>
<p>Este artículo presenta cómo enumerar los nombres de todos los archivos y carpetas en el disco duro en el formato de disco NTFS de Windows, y usar el STL de C ++ para construir una tabla hash, así como la GUI y los hilos de trabajo de MFC, y finalmente realizar la implementación basada en las palabras clave ingresadas por el usuario. Busque tan simple como la búsqueda de palabras clave de Google, y luego devuelva instantáneamente todos los archivos / carpetas coincidentes y obtenga de forma recursiva la ruta del sistema del archivo / carpeta. </p>
</blockquote>
<p>** Palabras clave *<em>: *</em> NTFS, rápido, palabra clave, búsqueda, ruta de archivo ** </p>
<h2 id="1-Introduccion"><a href="#1-Introduccion" class="headerlink" title="1. Introducción"></a>1. Introducción</h2><p>La estructura de directorios de Windows. En los volúmenes NTFS, los archivos son<br>Organizar en forma de árbol B +, presione cuando busque archivos en el directorio<br>El método de búsqueda del árbol B + busca primero el nodo raíz (comenzando desde el directorio raíz), y luego compara el nombre del archivo que se encuentra con el nombre del archivo correspondiente al nodo secundario en el nodo raíz para determinar qué nodo secundario corresponde al área de almacenamiento para buscar, y luego Utilice el nodo hijo como nodo raíz actual y busque de nuevo hasta encontrar el archivo. ^ [1] ^ </p>
<p>Aunque la búsqueda proporcionada por el sistema de Microsoft puede buscar contenido de texto, la velocidad es muy insatisfactoria. En la mayoría de los casos, solo queremos saber en qué carpeta de la computadora está almacenado el archivo, y este programa lo resuelve muy bien. </p>
<h2 id="2-Breve-introduccion-a-NTFS"><a href="#2-Breve-introduccion-a-NTFS" class="headerlink" title="2 Breve introducción a NTFS"></a>2 Breve introducción a NTFS</h2><h3 id="2-1-NTFS"><a href="#2-1-NTFS" class="headerlink" title="2.1 NTFS"></a>2.1 NTFS</h3><p>NTFS (Sistema de archivos de nueva tecnología) 是 Windows<br>El sistema de archivos estándar de NT y Windows posterior. NTFS reemplaza el sistema de archivos de la tabla de asignación de archivos (FAT) y proporciona un sistema de archivos para los sistemas operativos de la serie Windows de Microsoft. NTFS ha realizado varias mejoras en FAT y HPFS (sistema de archivos de alto rendimiento), por ejemplo, admite metadatos y utiliza estructuras de datos avanzadas para mejorar el rendimiento, la fiabilidad y la utilización del espacio en disco. ^ [2] ^ </p>
<h3 id="2-2-Situacion-actual"><a href="#2-2-Situacion-actual" class="headerlink" title="2.2 Situación actual"></a>2.2 Situación actual</h3><p>Con Windows basado en NT<br>Con la popularidad de 2000 / XP, muchos usuarios individuales han comenzado a utilizar NTFS. NTFS también usa clústeres como una unidad para almacenar archivos de datos, pero el tamaño del clúster en NTFS no depende del tamaño del disco o de la partición. Reducir el tamaño del clúster no solo reduce el desperdicio de espacio en disco, sino que también reduce la posibilidad de fragmentación del disco. NTFS admite la función de gestión de cifrado de archivos, que puede proporcionar a los usuarios un mayor nivel de garantía de seguridad. ^ [3] ^ </p>
<h2 id="3-Preparacion"><a href="#3-Preparacion" class="headerlink" title="3 Preparación"></a>3 Preparación</h2><h3 id="3-1-Ideas-de-diseno"><a href="#3-1-Ideas-de-diseno" class="headerlink" title="3.1 Ideas de diseño"></a>3.1 Ideas de diseño</h3><p>Lea todos los nombres de archivo del disco como datos y haga coincidir los datos de acuerdo con las palabras clave ingresadas por el usuario. La ruta correcta se devuelve al usuario junto con la ruta para facilitar la apertura del archivo. </p>
<p>La idea de diseño específica se muestra en la Figura 3-1. </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_00.jpg">Figura 3-1 Ideas de diseño</a> </p>
<p>La mayor ventaja de la tabla hash es que reduce en gran medida el tiempo consumido para el almacenamiento y la búsqueda de datos, que casi se puede considerar como un tiempo constante; el costo es solo para consumir más memoria. Sin embargo, con cada vez más memoria disponible, vale la pena intercambiar espacio por tiempo. Además, la facilidad de codificación también es una de sus características. </p>
<h3 id="3-2-Que-es-USN"><a href="#3-2-Que-es-USN" class="headerlink" title="3.2 Qué es USN"></a>3.2 Qué es USN</h3><p>La máxima prioridad del programa es leer el USN. </p>
<p>USN 是 Actualizar diario de número de servicio o cambio<br>La abreviatura de Journal, la función de registrar la información modificada en el volumen NTFS, puede establecer la cantidad de archivos y directorios que se monitorearán en la partición y registrar la hora de modificación y el contenido del objeto monitoreado. </p>
<p>Cuando el registro de USN está habilitado, para cada volumen NTFS, cuando hay información sobre cómo agregar, eliminar y modificar archivos, NTFS usa el registro de USN para registrarlo y almacenarlo como<br>El formato de USN_RECORD. </p>
<h3 id="3-3-¿Por-que-es-rapido"><a href="#3-3-¿Por-que-es-rapido" class="headerlink" title="3.3 ¿Por qué es rápido?"></a>3.3 ¿Por qué es rápido?</h3><p>El registro de USN es equivalente al directorio WORD y proporciona un índice. Por supuesto, cuando el contenido del artículo cambia, el registro de USN registrará cuándo se realiza la modificación, pero no registra lo que se modifica en él, por lo que el archivo de índice es muy pequeño. Y cuando desee encontrar el párrafo específico del artículo, no necesita girar la rueda del mouse violentamente, solo mire la tabla de contenido directamente, y solo necesita mantener presionada la tecla ctrl + clic del mouse para localizar. </p>
<p>De la misma manera, cuando desee encontrar un archivo determinado, puede averiguar directamente si el archivo existe buscando en el registro USN (es decir, el índice establecido). </p>
<p>PD: Aunque Windows no es “todo es un archivo” (Unix / Linux<br>Una de las filosofías básicas de), pero la carpeta también existe en forma de archivo, por lo que también puede encontrar la ubicación a través de USN. </p>
<h3 id="3-4-Medio-ambiente"><a href="#3-4-Medio-ambiente" class="headerlink" title="3.4 Medio ambiente"></a>3.4 Medio ambiente</h3><p>Dado que el formato NTFS es originalmente una patente de Microsoft, se proporcionan una serie de funciones API para nuestro conveniente acceso. </p>
<p>Como un Visual C ++ 6.0 antiguo pero clásico<br>Herramienta de programación, pero no había formato NTFS en ese momento, así que elegí VC2005 como el entorno de desarrollo integrado, y solo se puede ejecutar en sistemas Windows después del 2000. </p>
<h2 id="4-Implementacion-del-programa"><a href="#4-Implementacion-del-programa" class="headerlink" title="4 Implementación del programa"></a>4 Implementación del programa</h2><h3 id="4-1-Leer-USN"><a href="#4-1-Leer-USN" class="headerlink" title="4.1 Leer USN"></a>4.1 Leer USN</h3><p>Las siguientes son todas las funciones API proporcionadas por Microsoft ^ [4] ^, que están incluidas en el archivo de encabezado <code>&lt;Winioctl.h&gt;</code>. </p>
<h4 id="4-1-1-Determine-el-formato-del-disco"><a href="#4-1-1-Determine-el-formato-del-disco" class="headerlink" title="4.1.1 Determine el formato del disco"></a>4.1.1 Determine el formato del disco</h4><p>Llame a la siguiente función para encontrar el disco en formato NTFS </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GetVolumeInformation(</span><br><span class="line">	lpRootPathName: PChar;               <span class="comment">// 磁盘驱动器代码字符串</span></span><br><span class="line">	lpVolumeNameBuffer: PChar;           <span class="comment">// 磁盘驱动器卷标名称</span></span><br><span class="line">	nVolumeNameSize: DWORD;              <span class="comment">// 磁盘驱动器卷标名称长度</span></span><br><span class="line">	lpVolumeSerialNumber: PDWORD;        <span class="comment">// 磁盘驱动器卷标序列号</span></span><br><span class="line">	var lpMaximumComponentLength: DWORD; <span class="comment">// 系统允许的最大文件名长度</span></span><br><span class="line">    var lpFileSystemFlags: DWORD;        <span class="comment">// 文件系统标识</span></span><br><span class="line">	lpFileSystemNameBuffer: PChar;       <span class="comment">// 格式类型</span></span><br><span class="line">	nFileSystemNameSize: DWORD           <span class="comment">// 文件操作系统名称长度</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>El lpFileSystemNameBuffer, que es lo que queremos, devolverá “FAT32”, “NTFS” y otras cadenas. </p>
<p>Luego use un bucle para contar las letras de la unidad A-Z en formato NTFS, y luego inicialice </p>
<h4 id="4-1-2-Obtener-el-identificador-del-disco-de-la-unidad"><a href="#4-1-2-Obtener-el-identificador-del-disco-de-la-unidad" class="headerlink" title="4.1.2 Obtener el identificador del disco de la unidad"></a>4.1.2 Obtener el identificador del disco de la unidad</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HANDLE hVol = CreateFile(</span><br><span class="line">	<span class="string">&quot;盘符字符串&quot;</span>,  <span class="comment">// 必须如\.\C: (A-Z)的形式</span></span><br><span class="line">	GENERIC_READ | GENERIC_WRITE, <span class="comment">// 可以为</span></span><br><span class="line">	FILE_SHARE_READ | FILE_SHARE_WRITE, <span class="comment">// 必须包含有FILE_SHARE_WRITE</span></span><br><span class="line">	<span class="literal">NULL</span>, <span class="comment">// 这里不需要</span></span><br><span class="line">	OPEN_EXISTING, <span class="comment">// 必须包含OPEN_EXISTING, CREATE_ALWAYS可能会导致错误</span></span><br><span class="line">	FILE_ATTRIBUTE_READONLY, <span class="comment">// FILE_ATTRIBUTE_NORMAL可能会导致错误</span></span><br><span class="line">	<span class="literal">NULL</span>); <span class="comment">// 这里不需要</span></span><br></pre></td></tr></table></figure>

<p>Puntos a tener en cuenta: </p>
<ol>
<li>CreateFile devuelve un identificador, que se utilizará a continuación; </li>
<li>Dado que la letra de la unidad debe tener el formato <code>\\. \ C:</code>, la barra invertida “//“ en el lenguaje <code>C ++</code> representa “/“; </li>
<li>Se requieren derechos de administrador (Vista, UAC aparecerá en win7) </li>
</ol>
<p>Si <code>hVol! = INVALID_HANDLE_VALUE</code>, significa que el identificador se obtuvo correctamente y puede continuar con el siguiente paso. </p>
<h4 id="4-1-3-Inicializar-el-registro-de-USN"><a href="#4-1-3-Inicializar-el-registro-de-USN" class="headerlink" title="4.1.3 Inicializar el registro de USN"></a>4.1.3 Inicializar el registro de USN</h4><p>Utilice <code>FSCTL_CREATE_USN_JOURNAL</code> como el código de control de<code>DeviceIoControl</code>. </p>
<p><code>Cujd</code> es un puntero al búfer de entrada, que apunta a la estructura<code>CREATE_USN_JOURNAL_DATA</code>. </p>
<h4 id="4-1-4-Obtener-informacion-de-registro-de-USN"><a href="#4-1-4-Obtener-informacion-de-registro-de-USN" class="headerlink" title="4.1.4 Obtener información de registro de USN"></a>4.1.4 Obtener información de registro de USN</h4><p>Utilice <code>FSCTL_QUERY_USN_JOURNAL</code> como el código de control de<code>DeviceIoControl</code>. </p>
<p><code>lpOutBuffer</code> devuelve un<code>USN_JOURNAL_DATA</code>, que es una estructura </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    DWORDLONG UsnJournalID;</span><br><span class="line">    USN       FirstUsn;</span><br><span class="line">    USN       NextUsn;</span><br><span class="line">    USN       LowestValidUsn;</span><br><span class="line">    USN       MaxUsn;</span><br><span class="line">    DWORDLONG MaximumSize;</span><br><span class="line">    DWORDLONG AllocationDelta;</span><br><span class="line">&#125; USN_JOURNAL_DATA, *PUSN_JOURNAL_DATA;</span><br></pre></td></tr></table></figure>

<p><code>UsnJournalID</code>,<code>FirstUsn</code>, <code>NextUsn</code> se usarán en el siguiente paso </p>
<h4 id="4-1-5-Obtencion-de-informacion-de-archivo-de-USN-Journal"><a href="#4-1-5-Obtencion-de-informacion-de-archivo-de-USN-Journal" class="headerlink" title="4.1.5 Obtención de información de archivo de USN Journal"></a>4.1.5 Obtención de información de archivo de USN Journal</h4><p>Dado que <code>USN</code> se almacena en forma de<code>USN_RECORD</code>, su estructura es: </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	DWORD RecordLength; <span class="comment">// 记录长度</span></span><br><span class="line">	WORD MajorVersion; <span class="comment">// 主版本</span></span><br><span class="line">	WORD MinorVersion; <span class="comment">// 次版本</span></span><br><span class="line">	DWORDLONG FileReferenceNumber; <span class="comment">// 文件引用数</span></span><br><span class="line">	DWORDLONG ParentFileReferenceNumber; <span class="comment">// 父目录引用数</span></span><br><span class="line">	USN Usn; <span class="comment">// USN</span></span><br><span class="line">	LARGE_INTEGER TimeStamp; <span class="comment">// 时间戳</span></span><br><span class="line">	DWORD Reason; <span class="comment">// 原因</span></span><br><span class="line">	DWORD SourceInfo; <span class="comment">// 源信息</span></span><br><span class="line">	DWORD SecurityId; <span class="comment">// 安全</span></span><br><span class="line">	ID DWORD FileAttributes; <span class="comment">// 文件属性</span></span><br><span class="line">	WORD FileNameLength; <span class="comment">// 文件长度</span></span><br><span class="line">	WORD FileNameOffset; <span class="comment">// 文件名偏移</span></span><br><span class="line">	DWORD ExtraInfo1;</span><br><span class="line">	DWORD ExtraInfo2; DWORD ExtraInfo3; <span class="comment">// Hypothetically added in version 2.3</span></span><br><span class="line">	WCHAR FileName[<span class="number">1</span>]; <span class="comment">// 文件名第一位的指针</span></span><br><span class="line">&#125; USN_RECORD, *PUSN_RECORD;</span><br></pre></td></tr></table></figure>

<p>Tenga en cuenta el <code>FileReferenceNumber</code>,<code>ParentFileReferenceNumber</code>, <code>FileNameLength</code>,<code>FileName</code> </p>
<p>Estas variables son muy importantes </p>
<p><code>DeviceIoControl ()</code> coopera con <code>FSCTL_ENUM_USN_DATA</code> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="number">0</span>!=DeviceIoControl(hVol,</span><br><span class="line">	 	FSCTL_ENUM_USN_DATA,</span><br><span class="line">	 	&amp;med,</span><br><span class="line">	 	<span class="keyword">sizeof</span> (med),</span><br><span class="line">	 	Buffer,</span><br><span class="line">	 	BUF_LEN,</span><br><span class="line">	 	&amp;usnDataSize,</span><br><span class="line">	 	<span class="literal">NULL</span>)) &#123;</span><br><span class="line"></span><br><span class="line">	 	DWORD dwRetBytes = usnDataSize - <span class="keyword">sizeof</span> (USN);</span><br><span class="line">	 	<span class="comment">// 找到第一个 USN 记录</span></span><br><span class="line">	 	UsnRecord = (PUSN_RECORD)(((PCHAR)Buffer)+<span class="keyword">sizeof</span> (USN));</span><br><span class="line"></span><br><span class="line">	 	<span class="keyword">while</span> (dwRetBytes&gt;<span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">	 		<span class="comment">// 获取到的信息</span></span><br><span class="line">	 		<span class="function">CString <span class="title">CfileName</span><span class="params">(UsnRecord-&gt;FileName, UsnRecord-&gt;FileNameLength/<span class="number">2</span>)</span></span>;</span><br><span class="line">	 		pfrnName.filename = nameCur.filename = CfileName;</span><br><span class="line">	 		pfrnName.pfrn = nameCur.pfrn = UsnRecord-&gt;ParentFileReferenceNumber;</span><br><span class="line"></span><br><span class="line">	 		<span class="comment">// Vector</span></span><br><span class="line">	 		VecNameCur.push_back(nameCur);</span><br><span class="line"></span><br><span class="line">	 		<span class="comment">// 构建hash...</span></span><br><span class="line">	 		frnPfrnNameMap[UsnRecord-&gt;FileReferenceNumber] = pfrnName;</span><br><span class="line">	 		<span class="comment">// 获取下一个记录</span></span><br><span class="line">	 		DWORD recordLen = UsnRecord-&gt;RecordLength;</span><br><span class="line">	 		dwRetBytes -= recordLen;</span><br><span class="line">	 		UsnRecord = (PUSN_RECORD)(((PCHAR)UsnRecord)+recordLen);</span><br><span class="line"></span><br><span class="line">	 	&#125;</span><br><span class="line">	 	<span class="comment">// 获取下一页数据</span></span><br><span class="line">	 	med.StartFileReferenceNumber = \*(USN \*)&amp;Buffer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Entre ellos, <code>Med</code> es: </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MFT_ENUM_DATA med;</span><br><span class="line"></span><br><span class="line">med.StartFileReferenceNumber = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">med.LowUsn = <span class="number">0</span>;<span class="comment">//UsnInfo.FirstUsn;</span></span><br></pre></td></tr></table></figure>

<p>Después de probar aquí, se encuentra que si el uso de <code>FirstUsn</code> es a veces incorrecto, dando como resultado datos incompletos, es mejor escribir 0 directamente. </p>
<p><code>med.HighUsn = UsnInfo.NextUsn;</code> </p>
<p>En este bucle, el nombre de archivo obtenido cada vez se inserta en el vector y la tabla hash, respectivamente (descrito a continuación). </p>
<h4 id="4-1-6-Eliminar-archivo-de-registro-USN"><a href="#4-1-6-Eliminar-archivo-de-registro-USN" class="headerlink" title="4.1.6 Eliminar archivo de registro USN"></a>4.1.6 Eliminar archivo de registro USN</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DeviceIoControl(hVol,</span><br><span class="line">	FSCTL_DELETE_USN_JOURNAL,</span><br><span class="line">	&amp;dujd,</span><br><span class="line">	<span class="keyword">sizeof</span> (dujd),</span><br><span class="line">	<span class="literal">NULL</span>,</span><br><span class="line">	<span class="number">0</span>,</span><br><span class="line">	&amp;br,</span><br><span class="line">	<span class="literal">NULL</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-1-7-Resultados-de-enumerar-todos-los-archivos"><a href="#4-1-7-Resultados-de-enumerar-todos-los-archivos" class="headerlink" title="4.1.7 Resultados de enumerar todos los archivos"></a>4.1.7 Resultados de enumerar todos los archivos</h4><p>Guarde los datos como Allfile.txt para su análisis, como se muestra en la Figura 4-1. </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_01.jpg">图 4-1 Allfile.txt</a> </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_02.jpg">图 4-1 Allfile.txt</a> </p>
<p>Usé la unidad D en mi computadora como prueba y enumeré todos los archivos. Como se muestra en la figura, hay archivos de aproximadamente 40 W, un total de más de 100 W de datos y el tamaño del archivo es de aproximadamente 20 MB. Esto tiene una estimación vaga de la cantidad de memoria ocupada por los programas posteriores, que es de aproximadamente 50M. Incluso para 1G de memoria, está dentro de un rango razonable. Con los datos originales, el análisis es el siguiente: </p>
<p>Por ejemplo, el archivo Practice.isz de programación de Linux, su ruta del sistema es: <code>D: \ Ghost \ Linux \ Practice.isz de programación de Linux</code>, mire el resultado en el archivo: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">D:\</span><br><span class="line">Frn: 5000000000005</span><br><span class="line">Pfrn: NULL</span><br><span class="line">……</span><br><span class="line">……</span><br><span class="line">Ghost</span><br><span class="line">Frn: 20000000000fd</span><br><span class="line">Pfrn: 5000000000005</span><br><span class="line">……</span><br><span class="line">……</span><br><span class="line">Linux</span><br><span class="line">Frn: e0000000010d2</span><br><span class="line">Pfrn: 20000000000fd</span><br><span class="line">……</span><br><span class="line">……</span><br><span class="line">Linux编程实践.isz</span><br><span class="line">Frn: 190000000003b2</span><br><span class="line">Pfrn: e0000000010d2</span><br><span class="line">可以得出：</span><br><span class="line">Linux编程实践.isz-&gt;Pfrn &#x3D;&#x3D; Linux-&gt;Frn</span><br><span class="line">Linux-&gt;Pfrn &#x3D;&#x3D; Ghost-&gt;Frn</span><br><span class="line">Ghost-&gt;Pfrn &#x3D;&#x3D; D:\ -&gt; Frn</span><br><span class="line">D:\ -&gt; Pfrn 停止</span><br></pre></td></tr></table></figure>

<p>Entonces, usando una función recursiva (directa o indirectamente llamando a su propia función), puede obtener la ruta completa. </p>
<h3 id="4-2-Generar-datos-de-busqueda"><a href="#4-2-Generar-datos-de-busqueda" class="headerlink" title="4.2 Generar datos de búsqueda"></a>4.2 Generar datos de búsqueda</h3><h4 id="4-2-1-Construir-vector"><a href="#4-2-1-Construir-vector" class="headerlink" title="4.2.1 Construir vector"></a>4.2.1 Construir vector</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">name_cur</span> &#123;</span></span><br><span class="line">    CString filename;</span><br><span class="line">    DWORDLONG pfrn;</span><br><span class="line">&#125;Name_Cur;</span><br></pre></td></tr></table></figure>

<p>Vector: </p>
<p>Un contenedor secuencial. Se accede a los elementos del vector a través de su índice de posición. Puede llamar push_back o<br>La función de inserción agrega elementos al vector. En vector<br>Agregar elementos al contenedor puede causar la reasignación de espacio de memoria para el contenedor y también puede invalidar todos los iteradores. en<br>vector<br>Agregar (o eliminar) elementos en el medio del contenedor invalidará todos los iteradores que apuntan a elementos después del punto de inserción (o eliminación). </p>
<p>Use Vector para almacenar &lt;nombre de archivo, directorio actual&gt;. Debido a los requisitos de la búsqueda difusa, los métodos de búsqueda rápida como la búsqueda binaria no son aplicables aquí, y el método de recorrido lineal de Vector de principio a fin cumple con este requisito. . </p>
<h4 id="4-2-2-Construyendo-una-tabla-hash"><a href="#4-2-2-Construyendo-una-tabla-hash" class="headerlink" title="4.2.2 Construyendo una tabla hash"></a>4.2.2 Construyendo una tabla hash</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">pfrn_name</span> &#123;</span></span><br><span class="line">    DWORDLONG pfrn;</span><br><span class="line">    CString filename;</span><br><span class="line">&#125;Pfrn_Name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">map</span>&lt;DWORDLONG, Pfrn_Name&gt; Frn_Pfrn_Name_Map;</span><br></pre></td></tr></table></figure>

<p>Aquí usamos la función de biblioteca de mapas ^ [5] ^ proporcionada por STL, el mapa es una colección de pares clave-valor. mapa<br>El tipo generalmente se puede entender como una matriz asociativa (asociativa<br>array): puede usar la clave como un subíndice para obtener un valor, al igual que el tipo de matriz incorporado. La esencia de la asociación es que el valor de un elemento está asociado con una clave específica, en lugar de ser obtenido por la posición del elemento en la matriz. </p>
<ol>
<li>Teniendo en cuenta que si implementa la función hash usted mismo, puede haber varios errores que afecten el progreso, es mejor usar el mapa estable proporcionado por STL para implementarlo. </li>
<li>“No reinventar la rueda” No reinventar la rueda ^ [6] ^ <ol>
<li>Por ejemplo, Android de Google, ¿es la incapacidad de Google para desarrollar un kernel de sistema solo, por lo que utiliza un kernel de Linux muy maduro? Creo que es imposible que un gigante mundial como Google no tenga esta capacidad, sino que respeta el principio de no reinventar la rueda. </li>
</ol>
</li>
</ol>
<h4 id="4-2-3-Insertar-datos"><a href="#4-2-3-Insertar-datos" class="headerlink" title="4.2.3 Insertar datos:"></a>4.2.3 Insertar datos:</h4><p>Esto se usa aquí en la Sección 4.1.5, Obtenga USN Journal<br>En el ciclo de información del archivo, la información de <code>USN_RECORD</code> obtenida cada vez, el<code>nombre de archivo</code>,<br><code>pfrn</code> y<code>frn</code> se insertan en vector y tabla hash respectivamente. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pfrnName.filename &#x3D; nameCur.filename &#x3D; CfileName;</span><br><span class="line">pfrnName.pfrn &#x3D; nameCur.pfrn &#x3D; UsnRecord-&gt;ParentFileReferenceNumber;</span><br><span class="line">VecNameCur.push_back(nameCur);</span><br><span class="line">frnPfrnNameMap[UsnRecord-&gt;FileReferenceNumber] &#x3D; pfrnName;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-Interfaz"><a href="#4-3-Interfaz" class="headerlink" title="4.3 Interfaz"></a>4.3 Interfaz</h3><p>Al iniciar un proyecto, VC2005 proporciona proyectos de línea de comando (consola) y proyectos de GUI. La programación de la línea de comandos es muy conveniente, rápida, práctica y relativamente simple. Si la consola puede cumplir con los requisitos, la interfaz no es necesaria. O a veces, la plataforma de destino no puede mostrar la interfaz gráfica de usuario. pero,<br>La GUI tiene ventajas más obvias, como un sistema de menús y una mejor interactividad. Además, en el proceso de selección de menú y movimiento de datos entre campos,<br>El mouse es muy útil y la GUI es el camino a seguir. Por lo tanto, al escribir el programa, primero probé algunos datos intermedios en la consola y luego cambié a la interfaz GUI cuando terminó. </p>
<p>MFC: Microsoft Foundation Classes, también conocido como MFC<br>, Es de Microsoft<br>El mayor aporte realizado por el aburrimiento y la dificultad de programar. MFC<br>Hace que la generación de cuadros de diálogo sea extremadamente simple. También implementa un sistema de entrega de mensajes (mensaje<br>despacho), lidiando con los errores fáciles de WPARAM y LP ARAM. MFC<br>Incluso es la fuerza impulsora para atraer a algunas personas a C ++.<br>Este programa es implementado por MFC proporcionado por Microsoft, como se muestra en la Figura 4-2: </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_04.jpg">Figura 4-2 Interfaz MFC</a> </p>
<h4 id="4-3-1-Principio-KISS"><a href="#4-3-1-Principio-KISS" class="headerlink" title="4.3.1 Principio KISS"></a>4.3.1 Principio KISS</h4><p>El principio de KISS es “Keep It Sample Y<br>La abreviatura de “Stupid”, simplicidad y facilidad de uso son los principios más importantes del diseño. </p>
<p>El principio KISS es probablemente el más respetado en diseño, diseño de mejoras para el hogar, diseño de interfaz<br>En términos de diseño de operaciones, las cosas complejas se están volviendo cada vez más populares, mientras que las cosas simples son cada vez más reconocidas. Por ejemplo, estos diseños de UI y nuestras páginas web chinas son ejemplos negativos. “IKEA” (IKEA) ideas de producción y diseño del hogar simples y eficientes; concepto de “lo que ves es lo que obtienes” de “Microsoft” (Microsoft); estilo empresarial simple y directo de “Google” (Google), sin excepción, sigue El principio del “beso”. ^ [7] ^ </p>
<h4 id="4-3-2-Funcion"><a href="#4-3-2-Funcion" class="headerlink" title="4.3.2 Función"></a>4.3.2 Función</h4><p>Bajo el principio del beso, sea lo más conciso posible. Agregar cuadro de lista del botón Editbox<br>menu ^ [8] ^ Las funciones de estos controles son las siguientes: </p>
<ul>
<li>Cuadro de edición <ul>
<li>Obtener la cadena que el usuario debe buscar </li>
</ul>
</li>
<li>Botón <ol>
<li>Obtener la cadena en EditBox </li>
<li>El personaje es demasiado corto para mostrar un mensaje. </li>
<li>Agregue una imagen de lupa, la función es clara de un vistazo </li>
</ol>
</li>
<li>Cuadro de lista <ol>
<li>Muestre el nombre y la ruta del archivo coincidentes, haga doble clic para abrir el archivo </li>
<li>Dado que la ruta puede ser relativamente larga, agregue una barra de desplazamiento horizontal </li>
<li>Haga doble clic en la ruta del archivo de resultados en el cuadro de lista para abrir el archivo en el que se hizo doble clic. </li>
</ol>
</li>
<li>Menú <ul>
<li>Menú, puede seleccionar caso, orden de búsqueda </li>
</ul>
</li>
</ul>
<h3 id="4-4-Unir-hilo"><a href="#4-4-Unir-hilo" class="headerlink" title="4.4 Unir hilo"></a>4.4 Unir hilo</h3><h4 id="4-4-1-Por-que-unirse-a-hilos"><a href="#4-4-1-Por-que-unirse-a-hilos" class="headerlink" title="4.4.1 Por qué unirse a hilos"></a>4.4.1 Por qué unirse a hilos</h4><p>Los beneficios de los hilos: los hilos son baratos. El subproceso comienza más rápido, sale más rápido y tiene menos impacto en los recursos del sistema. </p>
<p>Considere también: </p>
<ol>
<li>Debido a la limitación de io, no tiene mucho sentido usar varios subprocesos para leer MFT al mismo tiempo en el mismo disco duro. </li>
<li>En cambio, el acceso del disco a la MFT ubicada en diferentes particiones del mismo disco duro puede afectar la velocidad. En el caso de equipos con varios discos duros, se debería mejorar considerablemente la eficiencia. Sin embargo, los usuarios de varios discos duros pueden formar una matriz RAID. La mejor solución debería ser leer los discos A-Z secuencialmente. </li>
<li>Cuando se creó el MFC por primera vez, se ejecutó secuencialmente. Como resultado, la interfaz no se podía mostrar hasta que se completaran todas las estadísticas de datos. Durante este proceso, los usuarios fácilmente perderían la paciencia. </li>
<li>Finalmente, decida un subproceso de la interfaz de usuario, un subproceso de trabajo de estadísticas de fondo. </li>
</ol>
<h4 id="4-4-2-Iniciar-un-hilo-de-trabajo-en-MFC"><a href="#4-4-2-Iniciar-un-hilo-de-trabajo-en-MFC" class="headerlink" title="4.4.2 Iniciar un hilo de trabajo en MFC"></a>4.4.2 Iniciar un hilo de trabajo en MFC</h4><p>MFC ha añadido durante mucho tiempo compatibilidad con subprocesos múltiples. En un MFC típico<br>En el programa, el soporte de multiproceso se oculta detrás de una gran cantidad de trabajo asombroso. MFC<br>Incluso intenta fortalecer ciertos conceptos de Win32 relacionados con el multiproceso. </p>
<p>Tanto la GUI como los subprocesos de trabajo se inician con AfxBeginThread (), pero MFC utiliza la naturaleza de sobrecarga de las funciones de C ++ para proporcionar dos declaraciones diferentes para esta función. El compilador seleccionará automáticamente el correcto para usar en función de los parámetros que proporcione. ^ [9] ^ </p>
<p>Utilice AfxBeginThread para iniciar el hilo.<br>pParam Cualquier valor de 4 bytes, utilizado para pasar al nuevo hilo. Puede ser un número entero, un puntero o simplemente un cero. </p>
<p>Aquí solo se utilizan los dos primeros parámetros, la función de subproceso en el objeto y el puntero del objeto </p>
<p>Puede ver dos subprocesos en el administrador de tareas, como se muestra en la Figura 4-3 </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_03.jpg">Figura 4-3 El Administrador de tareas muestra el número de subprocesos</a> </p>
<p>Cuando el hilo de trabajo finaliza su tarea, terminará automáticamente y volverá a un hilo. </p>
<h4 id="4-4-3-Minimizar-al-area-de-notificacion"><a href="#4-4-3-Minimizar-al-area-de-notificacion" class="headerlink" title="4.4.3 Minimizar al área de notificación"></a>4.4.3 Minimizar al área de notificación</h4><p>Ahora, cada vez más programas hacen clic en cerrar en la esquina superior derecha, que en realidad está minimizado al icono de la bandeja. Para salir del programa, debe hacer clic derecho en el icono de la bandeja para salir. </p>
<p>Realice la minimización sin salir del programa, puede encontrar archivos cómodamente. </p>
<p>1) Minimice la visualización en la barra de tareas. </p>
<p>2) Haga clic en Cerrar para salir al icono de la bandeja sin mostrarlo en la barra de tareas; haga doble clic para responder a la ventana de visualización. </p>
<p>3) Agregar menú al icono de la bandeja. </p>
<h3 id="4-5-Encontrar"><a href="#4-5-Encontrar" class="headerlink" title="4.5 Encontrar"></a>4.5 Encontrar</h3><h4 id="4-5-1-Comodin"><a href="#4-5-1-Comodin" class="headerlink" title="4.5.1 Comodín"></a>4.5.1 Comodín</h4><p>En aplicaciones reales, es imposible recordar el nombre del archivo con claridad, como test.2012-5-14.txt, que a menudo significa “prueba<br>.txt ”, por lo que se necesita una búsqueda aproximada. Porque debajo de la consola, el nombre del archivo es<br>pfrn&gt; Cree una tabla hash. Si desea implementar la búsqueda difusa, la tabla hash se vuelve innecesaria. Puede usar directamente el vector contenedor. </p>
<p>Según la situación real, no se requieren comodines estrictos, “\ *?”<br>Puede resolver la mayoría de los problemas de búsqueda, además, es posible que los usuarios generalmente no sepan el uso de comodines, y mucho menos expresiones regulares. Así que empieza con “espacio”<br>En lugar de “\ *?”, Implemente Baidu<br>El método de búsqueda de Google de separar palabras clave con espacios es una buena solución. \ * \ * \ * \ * </p>
<h4 id="4-5-2-Estuche-pedido"><a href="#4-5-2-Estuche-pedido" class="headerlink" title="4.5.2 Estuche, pedido"></a>4.5.2 Estuche, pedido</h4><p>En general, existen las dos situaciones siguientes: </p>
<ol>
<li>Es posible que el usuario no recuerde el caso del nombre del archivo o la ruta </li>
<li>A veces hay demasiados archivos y es posible que sea necesario utilizar mayúsculas estrictas para filtrar los archivos correctos. </li>
<li>No recuerdo el orden de las palabras clave </li>
</ol>
<p>Proporcione las siguientes dos opciones: </p>
<ol>
<li>Caso estricto </li>
<li>Sin orden </li>
</ol>
<p>Según la situación general, el valor predeterminado es: búsqueda secuencial que no distingue entre mayúsculas y minúsculas </p>
<h4 id="4-5-3-Privacidad-del-usuario-y-ruta-del-sistema"><a href="#4-5-3-Privacidad-del-usuario-y-ruta-del-sistema" class="headerlink" title="4.5.3 Privacidad del usuario y ruta del sistema"></a>4.5.3 Privacidad del usuario y ruta del sistema</h4><ol>
<li>Tenga en cuenta que algunas carpetas se utilizan para almacenar archivos privados de los usuarios. </li>
<li>Carpetas del sistema, como: <code>c: \ windows \ *</code>, que no es utilizada por los usuarios generales. La misma búsqueda solo aumentará los archivos innecesarios y cargará el sistema. </li>
</ol>
<p>Por lo tanto, es necesario agregar una opción de carpeta de exclusión, como se muestra en la Figura 4-4 </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_06.jpg">Figura 4-4 Excluir interfaz de carpeta</a> </p>
<p>La función correspondiente es: </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isIgnore</span><span class="params">( <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;\* pignorelist )</span> </span>&#123;</span><br><span class="line">	<span class="built_in">string</span> tmp = CW2A(path);</span><br><span class="line">	<span class="keyword">for</span> ( <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;::iterator it = pignorelist-&gt;begin();</span><br><span class="line">		it != pignorelist-&gt;end(); ++it ) &#123;</span><br><span class="line">			<span class="keyword">size_t</span> i = it-&gt;length();</span><br><span class="line">			<span class="keyword">if</span> ( !tmp.compare(<span class="number">0</span>, i, \*it,<span class="number">0</span>, i) ) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-5-4-Implementacion"><a href="#4-5-4-Implementacion" class="headerlink" title="4.5.4 Implementación"></a>4.5.4 Implementación</h4><p>Nueva clase de cadena coincidente </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cmpStrStr</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	cmpStrStr(<span class="keyword">bool</span> uplow, <span class="keyword">bool</span> inorder) &#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;uplow = uplow;</span><br><span class="line">		<span class="keyword">this</span>-&gt;isOrder = inorder;</span><br><span class="line">	&#125;</span><br><span class="line">	~cmpStrStr() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">cmpStrFilename</span><span class="params">(CString str, CString filename)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">infilename</span><span class="params">(CString &amp;strtmp, CString &amp;filenametmp)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">bool</span> uplow;</span><br><span class="line">	<span class="keyword">bool</span> isOrder;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Recorra VecNameCur en ** 4.2.1 **, pase la función de coincidencia cmpStrFilename y obtenga el nombre de archivo coincidente </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( <span class="built_in">vector</span>&lt;Name_Cur&gt;::const_iterator cit = VecNameCur.begin();</span><br><span class="line">	cit != VecNameCur.end(); ++cit) &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( cmpstrstr.cmpStrFilename(str, cit-&gt;filename) ) &#123;</span><br><span class="line">		path.Empty();</span><br><span class="line">		<span class="comment">// 还原 路径</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// vol:\  path \ cit-&gt;filename</span></span><br><span class="line">		getPath(cit-&gt;pfrn, path);</span><br><span class="line">		path += cit-&gt;filename;</span><br><span class="line">		<span class="comment">// path已是全路径</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ( isIgnore(pignorelist) ) &#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		rightFile.push_back(path);</span><br><span class="line">		<span class="comment">//path.Empty();</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cmpStrFilename函数：</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> end = str.GetLength();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ( pos &lt; end ) &#123;</span><br><span class="line">	<span class="comment">// 对于str，取得 每个空格分开为的关键词</span></span><br><span class="line">	pos = str.Find( _T(<span class="string">&#x27; &#x27;</span>) );</span><br><span class="line"></span><br><span class="line">	CString strtmp;</span><br><span class="line">	<span class="keyword">if</span> ( pos == <span class="number">-1</span> ) &#123;</span><br><span class="line">		<span class="comment">// 无空格</span></span><br><span class="line">		strtmp = str;</span><br><span class="line">		pos = end;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		strtmp = str.Mid(<span class="number">0</span>, pos<span class="number">-0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( !infilename(strtmp, filename) ) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	str.Delete(<span class="number">0</span>, pos);</span><br><span class="line">	str.TrimLeft(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Puede reescribir fácilmente el algoritmo de coincidencia de cadenas en la función infilename para lograr algunas extensiones </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CString <span class="title">filenametmp</span><span class="params">(filename)</span></span>;</span><br><span class="line"><span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( !uplow ) &#123;</span><br><span class="line">	<span class="comment">// 大小写敏感</span></span><br><span class="line">	filenametmp.MakeLower();</span><br><span class="line">	pos = filenametmp.Find(strtmp.MakeLower());</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	pos = filenametmp.Find(strtmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( <span class="number">-1</span> == pos ) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( !isOrder ) &#123;</span><br><span class="line">	<span class="comment">// 无顺序</span></span><br><span class="line">	filename.Delete(<span class="number">0</span>, pos+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-5-5-Salida-de-ruta"><a href="#4-5-5-Salida-de-ruta" class="headerlink" title="4.5.5 Salida de ruta"></a>4.5.5 Salida de ruta</h4><p>Después de obtener el nombre de archivo coincidente, el siguiente paso es obtener la ruta del sistema del archivo. Pase el nombre completo del nombre de archivo coincidente obtenido anteriormente en la tabla hash frnPfrnNameMap construida en ** 4.2.2 ** y obtenga la ruta de forma recursiva. </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CString <span class="title">Volume::getPath</span><span class="params">(DWORDLONG frn, CString &amp;path)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 查找2</span></span><br><span class="line">	Frn_Pfrn_Name_Map::iterator it = frnPfrnNameMap.find(frn);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (it != frnPfrnNameMap.end()) &#123;</span><br><span class="line"></span><br><span class="line">		  <span class="keyword">if</span> ( <span class="number">0</span> != it-&gt;second.pfrn ) &#123;</span><br><span class="line">		 	  getPath(it-&gt;second.pfrn, path);</span><br><span class="line">		  &#125;</span><br><span class="line"></span><br><span class="line">		  path += it-&gt;second.filename;</span><br><span class="line">		  path += ( _T(<span class="string">&quot;\&quot;) );</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	return path;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="5-Analisis-de-complejidad"><a href="#5-Analisis-de-complejidad" class="headerlink" title="5 Análisis de complejidad"></a>5 Análisis de complejidad</h2><h3 id="5-1-Complejidad-del-tiempo"><a href="#5-1-Complejidad-del-tiempo" class="headerlink" title="5.1 Complejidad del tiempo"></a>5.1 Complejidad del tiempo</h3><p>En teoría, la complejidad del tiempo es: </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_05.jpg">Figura 5-1 Análisis de complejidad</a> </p>
<p>En el procesador AMD Athlon (tm) II X2 245 2.9GHz, el resultado es casi instantáneo. </p>
<h3 id="5-2-Complejidad-espacial"><a href="#5-2-Complejidad-espacial" class="headerlink" title="5.2 Complejidad espacial"></a>5.2 Complejidad espacial</h3><p>Debido a la gran cantidad de archivos de computadora, generalmente de 10 W a 100 W, se puede ignorar el uso de memoria del programa. </p>
<p>234,708 archivos sobre 43M. </p>
<p>Para los sistemas con al menos 2G de memoria en la actualidad, no es una carga. </p>
<h2 id="6-Problemas-encontrados"><a href="#6-Problemas-encontrados" class="headerlink" title="6 Problemas encontrados"></a>6 Problemas encontrados</h2><h3 id="6-1-No-se-puede-inicializar-el-archivo-USN"><a href="#6-1-No-se-puede-inicializar-el-archivo-USN" class="headerlink" title="6.1 No se puede inicializar el archivo USN"></a>6.1 No se puede inicializar el archivo USN</h3><p>El disco O de la computadora no puede inicializar el archivo de registro USN. A través de la depuración, se encuentra que: </p>
<p>DeviceIoControl devuelve 0, GetLastError 0x70 </p>
<p>Verifique msdn, el motivo es ERROR_SHARING_PAUSED </p>
<p>Resulta que olvidó inicializar y agregar el siguiente código, el programa puede acceder al disco O normalmente </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE_USN_JOURNAL_DATA cujd;</span><br><span class="line">cujd.MaximumSize = <span class="number">0</span>; <span class="comment">// 0表示使用默认值</span></span><br><span class="line">cujd.AllocationDelta = <span class="number">0</span>; <span class="comment">// 0表示使用默认值</span></span><br></pre></td></tr></table></figure>

<h3 id="6-2-El-problema-de-wchar-y-char-bajo-Unicode"><a href="#6-2-El-problema-de-wchar-y-char-bajo-Unicode" class="headerlink" title="6.2 El problema de wchar y char bajo Unicode"></a>6.2 El problema de wchar y char bajo Unicode</h3><p>Inicialmente, en términos de procesamiento de cadenas, la cadena de función de biblioteca estándar se utilizó como método de procesamiento, pero en unicode<br>El siguiente es un wchar de doble byte, que se ha metido en muchos problemas en la conversión de cadenas Finalmente, CString se usa como cadena predeterminada y \ _T (“”) se usa para inicializar la cadena. </p>
<h3 id="6-3-Problema-de-posicion-ifdef"><a href="#6-3-Problema-de-posicion-ifdef" class="headerlink" title="6.3 Problema de posición #ifdef"></a>6.3 Problema de posición #ifdef</h3><p>\ #ifdef, no se pueden establecer puntos de interrupción en él, y luego noté que #define estaba escrito delante de include. </p>
<h3 id="6-4-Transferencia-de-parametros"><a href="#6-4-Transferencia-de-parametros" class="headerlink" title="6.4 Transferencia de parámetros"></a>6.4 Transferencia de parámetros</h3><p>Empecé a diseñar con un pensamiento orientado a procesos y me metí en la molestia de pasar el mismo identificador pasando parámetros. Más tarde, cambió a un método de clase para mejorar mucho. </p>
<h2 id="7-pequenas-optimizaciones"><a href="#7-pequenas-optimizaciones" class="headerlink" title="7 pequeñas optimizaciones"></a>7 pequeñas optimizaciones</h2><h3 id="7-1-Velocidad-de-lectura"><a href="#7-1-Velocidad-de-lectura" class="headerlink" title="7.1 Velocidad de lectura"></a>7.1 Velocidad de lectura</h3><p>Al construir la función hash, se pensaron en tres métodos y se realizaron experimentos respectivamente, utilizando la función de tiempo para contar el tiempo empleado. Los resultados son los siguientes: </p>
<p>1) Después de modificar el código, lea el usn una vez, guárdelo en un archivo temporal, lea y cree la tabla hash </p>
<p>Cada ejecución, el tiempo promedio es de aproximadamente 27 segundos. </p>
<p>2) Utilice vector para almacenar datos en la memoria, después de la liberación, </p>
<p>El resultado es gratificante y el tiempo se ha multiplicado por casi 10. ! ! Como se muestra en la Figura 7-1: </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_06.jpg">7-1 Recorrer todos los discos</a> </p>
<p>Está completamente dentro del rango aceptable. </p>
<p>La primera ejecución, obviamente, llevó mucho tiempo, y luego el archivo se leyó previamente de la caché del disco y la velocidad se disparó. El punto de acceso al análisis debe estar en el tiempo de búsqueda del disco y la lectura del archivo. </p>
<h3 id="7-2-Metodo-de-archivo-abierto"><a href="#7-2-Metodo-de-archivo-abierto" class="headerlink" title="7.2 Método de archivo abierto"></a>7.2 Método de archivo abierto</h3><p>En ** 4.3.2 **, haga doble clic en la ruta del archivo en ListBox para abrir el archivo de respuesta. Al principio, se usó la función del sistema system (), pero aparecerá una ventana de consola negra y la ventana principal se bloqueará, etc. La ejecución solo puede continuar después de cerrar el archivo, lo que es muy perjudicial para la experiencia del usuario. Llame a la función ShellExecute en su lugar para abrir un nuevo proceso y la ventana principal puede continuar ejecutándose. </p>
<h3 id="7-3-Barra-de-progreso"><a href="#7-3-Barra-de-progreso" class="headerlink" title="7.3 Barra de progreso"></a>7.3 Barra de progreso</h3><p>Después de que se lanzó la versión V1.0, no hubo ningún aviso cuando algunos estudiantes informaron el archivo de estadísticas de fondo, por lo que no sé cuándo se completará. Por lo tanto, se agrega una barra de progreso en la parte inferior de la interfaz principal para mejorar la interactividad, como se muestra en la figura.<br>7-2: </p>
<p>! <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/QSearch_07.jpg">Figura 7-2 Barra de progreso</a> </p>
<p>Por supuesto, la función de hilo también ha realizado los cambios necesarios: </p>
<h1 id="8-Conclusion"><a href="#8-Conclusion" class="headerlink" title="8 Conclusión"></a>8 Conclusión</h1><p>En este punto, las funciones básicas del programa se han completado. Probado en múltiples computadoras y diferentes sistemas (XP y series posteriores de Windows), básicamente no hay animaciones suspendidas y el programa se bloquea. </p>
<p>Debido al tiempo y otras razones, todavía hay muchas funciones que no se han implementado, como que la interfaz no se puede ampliar y los datos del archivo no se pueden recopilar de forma dinámica. </p>
<h1 id="referencias"><a href="#referencias" class="headerlink" title="referencias"></a>referencias</h1><p>[1] Informe técnico sobre hardware. Especificación del sistema de archivos NTFS [OL]. Biblioteca Baidu, 2011: 30.<br>[2] Beiyu. Investigación sobre varias tecnologías del sistema de archivos NTFS [OL]. 2007: 7.<br>[3] Bebés. Enciclopedia interactiva [OL]. Http://<a target="_blank" rel="noopener" href="http://www.hudong.com/wiki/ntfs">www.hudong.com/wiki/ntfs</a><br>[4] Microsoft. Biblioteca MSDN [OL]. 2012:<br>[5] Stanley B. Lippman / Josée LaJoie / Barbara E.Moo. C \ + \ + Primer [M]. Addison-Wesley Professional, 2006: 10.3<br>[6] Eric S. Raymond. Traductores: Jiang Hong, He Yuan, Cai Xiaojun. El arte de la programación UNIX [m]. Editorial de la industria electrónica, 2006:<br>[7] Chen Hao. Algunos principios del diseño de software [OL]. Http://coolshell.cn/articles/4535.html<br>[8] Sun Xin. VC ++ explicación detallada en profundidad [m]. Industria de la electrónica, 2006<br>[9] Jim Beveridge / Robert Wiener. Aplicaciones de subprocesos múltiples en Win32: la guía completa de subprocesos<br>[10] Addison-Wesley Professional, 1996: 223-243. </p>
<h1 id="Resumen-en-ingles"><a href="#Resumen-en-ingles" class="headerlink" title="Resumen en ingles"></a>Resumen en ingles</h1><p>** Posicionamiento rápido de los archivos de disco NTFS ** </p>
<p>LE IH Austria </p>
<p>(Escuela de Información y Computación, Universidad Agrícola de Anhui, Hefei 230036) </p>
<p>** Resumen ** ： Este artículo describe en el disco NTFS de Windows, el<br>enumeración de todos los nombres de los archivos y carpetas del disco duro,<br>y para crear una tabla hash utilizando C ++ STL, MFC GUI y subproceso de trabajo.<br>En última instancia, el usuario debe ingresar palabras clave, como una simple búsqueda como google<br>búsqueda de palabras clave, y luego devolver instantáneamente todos los archivos / carpetas coincidentes<br>y su ruta del sistema. </p>
<p>** Palabras clave: ** NTFS, rápido, búsqueda, palabras clave, ruta de archivo </p>

    </div>

    
    
    
      
  <div class="popular-posts-header">Entradas relacionadas</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/es/Go-Web/" rel="bookmark">Ir a la Web</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/es/Learn-Go-in-20-days/" rel="bookmark">Learn Go en 20 días</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/es/ios-developer-account-and-app-store/" rel="bookmark">Cuenta de desarrollador de iOS y cómo incluirla</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/es/count-lines-of-code/" rel="bookmark">Número de líneas de código</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/es/A-simple-VS-between-Sinatra-and-Martini/" rel="bookmark">Un simple VS. entre Sinatra y Martini</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me 👨‍💻 a coffee ☕️</div>
  <button onclick="document.querySelector('.post-reward').classList.toggle('active');">
    Donar
  </button>
  <div class="post-reward">
      <div>
        <img src="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/wechat.png" alt="LeiHao WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/alipay.png" alt="LeiHao Alipay">
        <span>Alipay</span>
      </div>
      <div>
        <img src="https://raw.githubusercontent.com/LeiHao0/BlogAssets/assets/bitcoin.png" alt="LeiHao Bitcoin">
        <span>Bitcoin</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/es/tags/programming/" rel="tag"># Programming</a>
              <a href="/es/tags/everything/" rel="tag"># Everything</a>
              <a href="/es/tags/ntfs/" rel="tag"># NTFS</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/es/Before-graduation/" rel="next" title="Más de diez días antes de la graduación">
                  Más de diez días antes de la graduación <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






      
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2012 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-laptop-code"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LeiHao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Cantidad total de caracteres">555k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Tiempo total de lectura">8:24</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/es/js/utils.js"></script><script src="/es/js/next-boot.js"></script>

  




  <script src="/es/js/local-search.js"></script>















  








  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://Artwalk.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://leihao0.github.io/es/QSearch/";
    this.page.identifier = "QSearch/";
    this.page.title = "La conjetura principal y la realización de todo";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://Artwalk.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
